# cabal-relink-test

Demonstrates a GHC issue that `-dynamic` executables are linked on every build (when we would wish that linking would be avoided on no-op builds).

## Example

```bash
cabal build
cabal build
```

The second build should not relink, but it does (as of GHC 8.0.2).

## Example output

Without `-dynamic`:

```
Building cabal-relink-test-0.1.0.0...
Preprocessing library cabal-relink-test-0.1.0.0...
Preprocessing executable 'cabal-relink-test' for cabal-relink-test-0.1.0.0...
[1 of 1] Compiling Main             ( app/Main.hs, dist/build/cabal-relink-test/cabal-relink-test-tmp/Main.o )
Linking dist/build/cabal-relink-test/cabal-relink-test ...

[nix-shell:~/src/haskell/cabal-relink-test]$ cabal build
Building cabal-relink-test-0.1.0.0...
Preprocessing library cabal-relink-test-0.1.0.0...
Preprocessing executable 'cabal-relink-test' for cabal-relink-test-0.1.0.0...
```

Note that there was no `Linking` output on the the second (no-op) build.

With `-dynamic` (see the `.cabal` file):

```
$ cabal build
Building cabal-relink-test-0.1.0.0...
Preprocessing library cabal-relink-test-0.1.0.0...
Preprocessing executable 'cabal-relink-test' for cabal-relink-test-0.1.0.0...
[1 of 1] Compiling Main             ( app/Main.hs, dist/build/cabal-relink-test/cabal-relink-test-tmp/Main.o )
Linking dist/build/cabal-relink-test/cabal-relink-test ...

$ cabal build
Building cabal-relink-test-0.1.0.0...
Preprocessing library cabal-relink-test-0.1.0.0...
Preprocessing executable 'cabal-relink-test' for cabal-relink-test-0.1.0.0...
Linking dist/build/cabal-relink-test/cabal-relink-test ...
```
